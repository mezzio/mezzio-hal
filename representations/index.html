<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Hypertext Application Language for PSR-7 Applications">  
    <link rel="canonical" href="https://docs.mezzio.dev/mezzio-hal/representations/">
    <link rel="shortcut icon" href="https://docs.laminas.dev/img/trademark-laminas-foundation-rgb.svg">

    <title>Representations - mezzio-hal - Laminas Docs</title>

    <link rel="stylesheet" href="https://docs.laminas.dev/css/styles.css">
</head>
<body id="page-top" class="mezzio">

    
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
        
        <a class="logo-link navbar-brand offset-md-2" href="https://getlaminas.org/" data-tooltip data-placement="bottom" title="Go to the Laminas homepage">
            <img src="https://docs.laminas.dev/img/laminas-foundation-white.svg" height="28" alt="Laminas">
        </a>
        <a class="navbar-title" href="https://docs.laminas.dev/" data-tooltip data-placement="bottom" title="Go to the Laminas Documentation">
            Documentation
        </a>

        
        <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">

            
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <div class="dropdown">
                        <a class="dropdown-toggle nav-link" data-toggle="dropdown" aria-expanded="false">
                            All Docs
                        </a>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a class="dropdown-item" href="https://docs.laminas.dev/components">Components</a>
                            <a class="dropdown-item" href="https://docs.mezzio.dev/">Mezzio</a>
                            <a class="dropdown-item" href="https://api-tools.getlaminas.org/">API Tools</a>
                            <a class="dropdown-item" href="https://docs.laminas.dev/mvc">MVC</a>
                        </div>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="https://getlaminas.org/participate" class="nav-link">Community</a>
                </li>
            </ul>

            
            
                <div class="d-block d-sm-none">
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="..">mezzio-hal</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../intro/" class="subnavigation__link">Introduction</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Reference</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../hal/" class="subnavigation__link">HAL</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../links-and-resources/" class="subnavigation__link">Links and Resources</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../resource-generator/" class="subnavigation__link">Generating Resources</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../cookbook/generating-custom-resources/" class="subnavigation__link">Custom Resources</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Representations</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../doctrine/" class="subnavigation__link">Generating HAL for Doctrine Entities</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../factories/" class="subnavigation__link">Factories</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Cookbook</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../cookbook/generating-custom-links-in-middleware/" class="subnavigation__link">Generating Custom Links In Middleware and Request Handlers</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../cookbook/path-segregated-uri-generation/" class="subnavigation__link">Using the ResourceGenerator in path-segregated middleware</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            
        </ul>
    </div>

                </div>
            

            
            <div class="d-block d-sm-none">
                <div class="component-selector">
    
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
            </div>
        </div>
    </div>
</nav>

    
    <header class="header">
    <div class="container">
        <div class="row">

            
            <div class="col-6 offset-md-2">
                <h1 class="header__title">
                    Mezzio

                    
                        <small class="header__subtitle">mezzio-hal</small>
                    
                </h1>
            </div>

            
            <div class="col-4 text-sm-right">
                
                    

                    <a href="#" class="header__link header__link--search" data-toggle="modal" data-target="#mkdocs_search_modal" title="Open search">
                        <i class="fa fa-search"></i> Search
                    </a>
                    <a href="https://github.com/mezzio/mezzio-hal/" class="header__link header__link--github" title="Go to repository of mezzio-hal">
                        <i class="fa fa-github"></i> GitHub
                    </a>
                
            </div>
        </div>
    </div>
</header>

    
    <div class="container">
        <div class="row">
            <div class="col-md-2 col-sm-12">
                
                
                    
    

    
    
        <div class="toc">
            <h6 class="toc__headline">On this page</h6>
            <ul class="toc__list">
                
                    <li class="toc__entry">
                        <a href="#renderers" class="toc__link">Renderers</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#halresponsefactory" class="toc__link">HalResponseFactory</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#using-the-factory" class="toc__link">Using the factory</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#forcing-collections-for-relations" class="toc__link">Forcing collections for relations</a>
                    </li>
                
            </ul>
        </div>
    

                
            </div>
            <div class="col-md-7 col-sm-12 content" role="main" data-spy="scroll" data-target=".toc">
                
                    <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        
            <li class="breadcrumb-item"><a href="https://docs.laminas.dev/">Overview</a></li>
            <li class="breadcrumb-item"><a href="https://docs.mezzio.dev/">Mezzio</a></li>

            
                <li class="breadcrumb-item"><a href="..">mezzio-hal</a></li>

                
                    
                        
                        
                            <li class="breadcrumb-item">Reference</li>
                        
                    
                

                <li class="breadcrumb-item active" aria-current="page">Representations</li>
            
        
    </ol>
</nav>






    
    
        <h2 class="chapter__headline">Reference</h2>
    

    <h1 id="generating-representations">Generating Representations</h1>
<p>This component provides two renderers, one each for creating JSON and XML
payloads.</p>
<p>Additionally, as noted in the <a href="../intro/">introduction</a> examples, this component
provides <code>Mezzio\Hal\HalResponseFactory</code> for generating a
<a href="https://www.php-fig.org/psr/psr-7/">PSR-7</a> response containing the HAL
representation. This chapter dives into that with more detail.</p>
<h2 id="renderers">Renderers</h2>
<p>All renderers implement <code>Mezzio\Hal\Renderer\RendererInterface</code>:</p>
<pre class=codehilite><code class=language-php>namespace Mezzio\Hal\Renderer;

use Mezzio\Hal\HalResource;

interface RendererInterface
{
    public function render(HalResource $resource) : string;
}</code></pre>
<p>Two implementations are provided, <code>Mezzio\Hal\Renderer\JsonRenderer</code> and
<code>Mezzio\Hal\Renderer\XmlRenderer</code></p>
<h3>JsonRenderer</h3>
<p>The <code>JsonRenderer</code> constructor allows you to specify a bitmask of flags for use
with <code>json_encode()</code>. By default, if none are provided, it uses the value of
<code>JsonRenderer::DEFAULT_JSON_FLAGS</code>, which evaluates to:</p>
<pre class=codehilite><code class=language-php>JSON_UNESCAPED_SLASHES
| JSON_UNESCAPED_UNICODE
| JSON_PRESERVE_ZERO_FRACTION</code></pre>
<p>When your application is in "debug" mode, it also adds the <code>JSON_PRETTY_PRINT</code>
flag to the default list, in order to provide human-readable JSON output.</p>
<h3>XmlRenderer</h3>
<p>The <code>XmlRenderer</code> produces XML representations of HAL resources. It has no
constructor arguments at this time.</p>
<h2 id="halresponsefactory">HalResponseFactory</h2>
<p><code>HalResponseFactory</code> generates a PSR-7 response containing a representation of
the provided <code>HalResource</code> instance. In order to keep the component agnostic of
PSR-7 implementation, <code>HalResponseFactory</code> itself composes a callable factory
capable of producing an empty PSR-7 response.</p>
<p>As an example:</p>
<pre class=codehilite><code class=language-php>use Slim\Http\Response;
use Slim\Http\Stream;
use Mezzio\Hal\HalResponseFactory;

$factory = new HalResponseFactory(
    function () {
        return new Response();
    }
);</code></pre>
<p>Additionally, the <code>HalResponseFactory</code> constructor can accept the following
arguments, with the described defaults if none is provided:</p>
<ul>
<li>A <code>JsonRenderer</code> instance is created if none is provided.</li>
<li>An <code>XmlRenderer</code> instance is created if none is provided.</li>
</ul>
<p>We provide a <a href="https://www.php-fig.org/psr/psr-11">PSR-11</a> compatible factory for
generating the <code>HalResponseFactory</code>, described in <a href="../factories/#laminasmezziohalhalresponsefactoryfactory">the factories
chapter</a>.</p>
<h2 id="using-the-factory">Using the factory</h2>
<p>The factory exposes one method:</p>
<pre class=codehilite><code class=language-php>use Psr\Http\Message\ResponseInterface;
use Psr\Http\Message\ServerRequestInterface;
use Mezzio\Hal\HalResource;

public function createResponse(
    ServerRequestInterface $request,
    HalResource $resource,
    string $mediaType = self::DEFAULT_CONTENT_TYPE
) : ResponseInterface {</code></pre>
<p>Generally speaking, you'll pass the current request instance, and the resource
for which you want to generate a response, and the factory will return a
response based on its response prototype, with the following:</p>
<ul>
<li>A <code>Content-Type</code> header with the base media type of <code>application/hal</code>.</li>
<li>A message body containing the representation.</li>
</ul>
<p>The request instance is used to determine what representation to create, based
on the <code>Accept</code> header. If it matches a JSON media type, a JSON representation
is created, and the <code>Content-Type</code> will be appended with <code>+json</code>; for XML, an
XML representation is created, and the <code>Content-Type</code> will be appended with
<code>+xml</code>. If no media type is matched, XML is generated.</p>
<p>One practice often used is to provide a <em>custom media type</em> for your
representations. While they will still be HAL, this allows you to document the
specific structure of your resources, and potentially even validate them against
JSON schema.</p>
<p>To do this, pass the media type when creating the response:</p>
<pre class=codehilite><code class=language-php>$response = $factory-&gt;createResponse(
    $request,
    $resource,
    'application/vnd.book'
);</code></pre>
<p><em>Do not</em> pass the format (e.g., <code>+json</code>, <code>+xml</code>) when doing so; the factory will
append the appropriate one based on content negotiation.</p>
<h2 id="forcing-collections-for-relations">Forcing collections for relations</h2>
<p>HAL allows links and embedded resources to be represented as:</p>
<ul>
<li>a single object</li>
<li>an array of objects of the same type</li>
</ul>
<p>Internally, this package checks to see if only one of the item exists, and, if
so, it will render it by itself. However, there are times you may want to force
an array representation. As an example, if your resource models a car, and you
have a <code>wheels</code> relation, it would not make sense to return a single wheel, even
if that's all the car currently has associated with it.</p>
<p>To accommodate this, we provide two features.</p>
<p>For links, you may pass a special attribute, <code>Mezzio\Hal\Link::AS_COLLECTION</code>,
with a boolean value of <code>true</code>; when encountered, this will then be rendered as
an array of links, even if only one link for that relation is present.</p>
<pre class=codehilite><code class=language-php>$link = new Link(
    'wheels',
    '/api/car/XXXX-YYYY-ZZZZ/wheels/111',
    false,
    [Link::AS_COLLECTION =&gt; true]
);

$resource = $resource-&gt;withLink($link);</code></pre>
<p>In the above, you will then get the following within your representation:</p>
<pre class=codehilite><code class=language-json>&quot;_links&quot;: {
  &quot;wheels&quot;: [
    {&quot;href&quot;: &quot;/api/car/XXXX-YYYY-ZZZZ/wheels/111&quot;}
  ]
}</code></pre>
<p>To force an embedded resource to be rendered within an array, you have two
options.</p>
<p>First, and simplest, pass the resource within an array when calling
<code>withElement()</code>, <code>embed()</code>, or passing data to the constructor:</p>
<pre class=codehilite><code class=language-php>// Constructor:
$resource = new HalResource(['wheels' =&gt; [$wheel]]);

// withElement():
$resource = $resource-&gt;withElement('wheels', [$wheel]);

// embed():
$resource = $resource-&gt;embed('wheels', [$wheel]);</code></pre>
<p>Alternately, you can call the <code>HalResource::embed</code> method with only the
resource, passing the method a third argument, a flag indicating whether or not
to force an array:</p>
<pre class=codehilite><code class=language-php>$resource = $resource-&gt;embed('wheels', $wheel, true);</code></pre>
<p>In each of these cases, assuming no other wheels were provided to the final
resource, you might get a representation such as the following:</p>
<pre class=codehilite><code class=language-json>&quot;_embedded&quot;: {
  &quot;wheels&quot;: [
    {
      &quot;_links&quot; =&gt; {&quot;self&quot;: {&quot;href&quot;: &quot;...&quot;}}
      &quot;id&quot;: &quot;...&quot;
    },
  ]
}</code></pre>




    <nav>
    <ul class="page-nav hidden-print">

        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../cookbook/generating-custom-resources/">
                    <i class="fa fa-chevron-left"></i> Previous
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../doctrine/">
                    Next <i class="fa fa-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>




    <div class="help-wanted">
        <p>
            Found a mistake or want to contribute to the documentation?
            <a href="https://github.com/mezzio/mezzio-hal/edit/master/docs/book/representations.md" target="_blank" class="help-wanted__link">
                Edit this page on GitHub!
            </a>
        </p>
    </div>

                
            </div>
            <div class="col-md-3 col-sm-12 sidebar">
                
                    <div class="component-selector">
    
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="..">mezzio-hal</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../intro/" class="subnavigation__link">Introduction</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Reference</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../hal/" class="subnavigation__link">HAL</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../links-and-resources/" class="subnavigation__link">Links and Resources</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../resource-generator/" class="subnavigation__link">Generating Resources</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../cookbook/generating-custom-resources/" class="subnavigation__link">Custom Resources</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Representations</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../doctrine/" class="subnavigation__link">Generating HAL for Doctrine Entities</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../factories/" class="subnavigation__link">Factories</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Cookbook</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../cookbook/generating-custom-links-in-middleware/" class="subnavigation__link">Generating Custom Links In Middleware and Request Handlers</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../cookbook/path-segregated-uri-generation/" class="subnavigation__link">Using the ResourceGenerator in path-segregated middleware</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            
        </ul>
    </div>

                
            </div>
        </div>
    </div>

    
    <footer class="footer">
    <div class="container">

        
        <div class="row">
            <div class="col-md-12 text-center">
                <a class="footer__button" href="#page-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="row">
            <div class="col-md-7 offset-md-2">
                <h5>Laminas</h5>
                <ul>
                    <li>Laminas Project <a href="https://getlaminas.org/">The new foundation for the community-supported, open source continuation of Zend Framework</a></li>
                    <li>Laminas Components and MVC <a href="https://docs.laminas.dev/">Components and MVC for enterprise applications</a></li>
                    <li>Mezzio <a href="https://docs.mezzio.dev/">PSR-15 middleware in minutes</a></li>
                    <li>Laminas API Tools <a href="https://api-tools.getlaminas.org/">Build RESTful APIs in minutes</a></li>
                </ul>
            </div>
        </div>

        <div class="row">

            
            <div class="col-md-4 offset-md-2">
                <h4 class="footer__headline">Support</h4>
                <ul class="support__list">
                    <li class="support__list-item">
                        <a href="https://discourse.laminas.dev" class="support__link" title="Forum"><i class="fa fa-comments"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://laminas.dev/chat" class="support__link" title="Chat"><i class="fa fa-slack"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://github.com/laminas" class="support__link" title="Github"><i class="fa fa-github"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://twitter.com/getlaminas" class="support__link" title="Twitter"><i class="fa fa-twitter"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://getlaminas.org/blog/feed-rss.xml" class="support__link" title="Blog feed"><i class="fa fa-rss"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://getlaminas.org/security/feed" class="support__link" title="Security feed"><i class="fa fa-rss-square"></i></a>
                    </li>
                </ul>
            </div>

            
            <div class="col-md-3">
                <h4 class="footer__headline">License</h4>
                <p>
                    Code licensed under <a
                        href="https://github.com/mezzio/mezzio-hal/blob/master/LICENSE.md">BSD 3-Clause</a>.
                </p>
            </div>

            
            <div class="col-md-3">
                <h4 class="footer__headline">Copyright</h4>
                <p>
                    <!--Built with love by the Laminas team with the help of our
                    <a href="https://github.com/mezzio/mezzio-hal/graphs/contributors">contributors</a>.<br>-->
                    &copy; 2019-2020 by <a href="https://getlaminas.org/">The Laminas Project</a>.
                </p>
            </div>
        </div>
    </div>
</footer>

    <script>
        let base_url = '..',
            project  = "mezzio",
            siteName = 'mezzio-hal';
    </script>
    <script src="https://docs.laminas.dev/js/scripts.js"></script>
        <script src="../search/main.js"></script>

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Search</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
            </div>
            <div class="modal-body">
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search in mezzio-hal" id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
        </div>
    </div>
</div>
</body>


</html>
